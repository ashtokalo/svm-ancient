 ;---------------------------------------------------------------------------
 ;                                Terminal
 ;                               Version 1.0
 ;                      Copyright (C) 1999 ShAG Studio
 ;---------------------------------------------------------------------------
 ;    Этот модуль содержит процедуры для вывода на терминальное устройство.
 ; В версии  1.0 терминальным устройством служит текстовый экран, но только
 ; в том случае,  если в  данный  момент  не  инициализированно графическое
 ; устройство.
 ;
 ; Список процедур доступных для вызова:
 ;    CreatTrmStream - создать поток терминала
 ;    WriteChar      - вывести на терминал один символ
 ;    WriteString    - вывести на терминал ASCIIZ строку
 ;
 ;    Чтобы  использовать этот  модуль вы должны  вставить в свою программу
 ; следующюю строку: INCLUDE Terminal.inc  или добавить через запятую, если
 ; директива INCLUDE уже где-то использовалась.
 ;---------------------------------------------------------------------------
  INCLUDE   Stream.inc  ; подключаем модуль для работы с потоками
  INCLUDE   Strings.inc ; подключаем модуль для работы со строками

  TrmStream DD 0  ; номер потока терминала

 ;---------------------------------------------------------------------------
 ; CreatTrmStream - создать поток терминала
 ;---------------------------------------------------------------------------
 ; Вход:
 ;  нет
 ; Выход:
 ;  EDX - номер потока терминала
 ; Регистры:
 ;  EDX
 ;---------------------------------------------------------------------------
 PROC CreatTrmStream
  PUSH LAX
  MOV  LAX, 1
  CSP  3
  MOV  DWORD [TrmStream], EDX
  POP  LAX
  RET

 ;---------------------------------------------------------------------------
 ; WriteChar - вывести на терминал один символ
 ;---------------------------------------------------------------------------
 ; Вход:
 ;  BL - ASCII код символа
 ; Выход:
 ;  нет
 ; Регистры:
 ;  BL
 ;---------------------------------------------------------------------------
 PROC WriteChar
  PUSH LAX
  PUSH EDX
  MOV  DWORD EDX, [TrmStream]
  CALL WriteByte
  POP  EDX
  POP  LAX
  RET

 ;---------------------------------------------------------------------------
 ; WriteString - вывести на терминал ASCIIZ строку
 ;---------------------------------------------------------------------------
 ; Вход:
 ;  LEP - адрес выводимой ASCIIZ строки
 ; Выход:
 ;  нет
 ; Регистры:
 ;  LEP
 ;---------------------------------------------------------------------------
 PROC WriteString
  PUSH LAX
  PUSH EDX
  PUSH LCX
  CALL Length
  MOV  DWORD EDX, [TrmStream]
  CALL WriteArray
  POP  LCX
  POP  EDX
  POP  LAX
  RET